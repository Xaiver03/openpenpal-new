## **一、模块定位**

OpenPenPal 的 AI 子系统致力于在不破坏平台“真实温度感”的前提下，为用户提供“灵感生成 + 情绪共鸣 + 内容中转 + 社交辅助”的温柔支持。它不承担主体内容创作职能，而是以“写作助理”和“情绪共鸣者”的身份嵌入写信流程与信件生态。

---

## **二、核心目标**

|**目标**|**描述**|
|---|---|
|不破坏人文气息|拒绝自动生成完整信件；始终强调“人写给人”的信件本质|
|降低写信门槛|为用户提供“灵感卡片”“信纸引导”“格式模板”等|
|丰富信件流转形式|支持漂流信 AI 匹配、AI 笔友模拟等交互方式|
|提升内容组织与展览能力|AI 参与信件主题策展、信件博物馆归类与展示|
|保持慢节奏与仪式感|所有 AI 行为具备延时或等待机制，不打破用户的耐心回路|

---

## **三、功能模块**

### **3.1 自由笔友匹配（AI内容画像引导匹配）**

|**功能说明**|
|---|
|用户写匿名信并选择“漂流信 → AI匹配”后，平台提取关键信息（如情绪、主题、写作风格）|
|系统根据内容计算“语义共鸣度”，匹配当前系统中最契合的收件人编码|
|匹配完成后自动将该编码绑定至该信条码（不公开收件人姓名）|

### **3.2 AI虚拟笔友（模拟通信）**

|**功能说明**|
|---|
|用户选择 AI 笔友主题（如“30岁的我”“文艺少年”“外星观察员”等）|
|发出一封信 → AI根据角色设定在24小时内“回信”|
|所有通信保存于“AI笔友箱”，不计入真实投递记录，便于练笔与心理陪伴|

### **3.3 写作灵感卡片（写作引导）**

|**类型**|**示例**|
|---|---|
|时间型|“今天是7月26日，去年此时你在做什么？”|
|情感型|“用一封信，把你不敢当面说的那句话写出来”|
|角色型|“假如你是树洞，可以接住谁的秘密？”|
|话题联想型|“看到‘毕业’这个词，你脑海里第一个画面是？”|

> 灵感卡片可作为进入写信页面的“起始建议卡片”，提升打开率与内容质量

### **3.4 信件博物馆策展助手**

|**功能说明**|
|---|
|用户将已公开的信件授权提交至“信件博物馆”|
|AI 将其按主题（如“未寄出的信”“毕业季”“写给陌生人”等）归类并命名展区|
|展示效果由 AI 决定顺序、摘录语句、策展文案，形成“AI协同下的人类情感博物馆”|

---

## **四、节奏控制机制（慢节奏策略）**

|**模块**|**限制机制说明**|
|---|---|
|AI匹配寄信|匹配过程需等待1小时以内，模拟“漂流”不确定性|
|AI笔友回信|首封回信需延迟至少8小时；后续每次通信需间隔24小时|
|灵感卡片更新|每日推送不超过2条，避免打断真实情绪生成|
|AI展示推荐|不主动推送 AI 内容，仅在用户主动进入或完成动作后展示|

---

## **五、用户界面（UI建议）**

|**场景**|**AI功能入口**|
|---|---|
|写信页面上方|显示灵感卡片模块（最多1张/天）|
|信件完成后页面|弹出“是否选择 AI匹配寄信”或“写信给 AI笔友”|
|公开信查看页面|展示“博物馆策展：本信件被收录于【___】”|

---

## **六、数据结构（简要）**

```
AIMatchRecord {
  match_id: string,
  letter_id: string,
  semantic_profile: string[],
  matched_code: string,
  strategy: "emotion-first" | "topic-first",
  timestamp: datetime
}

AIPenpalMessage {
  user_id: string,
  penpal_theme: string,
  messages: [
    { role: "user", content: string },
    { role: "ai", content: string, delay_ms: number }
  ],
  created_at: datetime
}
```

---

## **七、安全性与边界设置**

|**项目**|**限制说明**|
|---|---|
|内容生成限制|AI不得生成带有真实姓名、联系信息、内容过长或攻击性表达的信件内容|
|数据收集策略|匿名信件仅在用户授权下参与AI画像/训练|
|决策不可逆限制|AI漂流匹配一旦完成，绑定收件人后不能撤回（模拟“寄出即不可控”）|
|模型迭代机制|所有行为在小批量灰度中进行评估，不影响主线体验|

---

## **八、与其他模块接口说明**

|**模块**|**描述**|
|---|---|
|写信系统|灵感卡片 → 引导用户写信 → 完成后支持 AI 匹配或 AI 笔友投送|
|条码系统|匹配成功后将收件人 OP Code 写入条码绑定项|
|信使系统|AI 中转漂流信需系统调度信使 → 投递更新状态|
|信件博物馆系统|与用户公开信件 API 联动，提取内容并自动策展归类|
