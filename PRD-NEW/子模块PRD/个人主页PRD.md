
## **OpenPenPal 个人主页原型布局**

```
graph TD
    A[个人主页顶栏] --> A1[头像 + 昵称 + 等级徽章]
    A --> A2[邮编信息 + 编辑按钮]
    A --> A3[积分 / 勋章 / 信使等级统计]

    B[导航标签栏] --> B1[📮 我的信件]
    B --> B2[🖋 我的作品]
    B --> B3[🎒 信使任务]
    B --> B4[🏛 收藏 & 展览]

    C1[📮 我的信件页]
    C1 --> C1a[寄出记录(状态: 在路上/已送达)]
    C1 --> C1b[收信记录(已读/未读/回信入口)]
    C1 --> C1c[漂流信(匿名/公开标签)]
    C1 --> C1d[未来信(解锁时间显示)]

    C2[🖋 我的作品页]
    C2 --> C2a[公开信件]
    C2 --> C2b[随笔/短诗]
    C2 --> C2c[收藏夹]

    C3[🎒 信使任务页]
    C3 --> C3a[今日任务清单(编号/地点/状态按钮)]
    C3 --> C3b[扫码录入 & 确认送达]
    C3 --> C3c[历史任务记录]
    C3 --> C3d[信使积分 & 排行榜入口]

    C4[🏛 收藏 & 展览页]
    C4 --> C4a[精选信件数字展厅]
    C4 --> C4b[主题活动参展作品]
    C4 --> C4c[下载/分享按钮]
```

---

### **页面分区说明**

1. **顶栏（Header）**
    
    - 头像、昵称、等级徽章（写信等级/信使等级两种可能并列）
        
    - 邮编信息 + 快捷编辑
        
    - 积分总览（写信积分、信使积分）

2. **导航栏（Tab）**
    
    - 我的信件 / 我的作品 / 信使任务 / 收藏&展览
        
    - 适配移动端左右滑动

3. **内容区（Main Content）**
    
    - 不同标签切换内容
        
    - 列表卡片样式，每条信件/任务卡片都有状态标签与操作按钮

4. **底部操作栏（Mobile Friendly）**
    
    - 写信按钮
        
    - 扫码按钮（信封编号绑定/任务登记）
        
    - 主页、广场、商城、通知快捷入口

---

### **界面层次示意**

```
[顶栏] 
 ├─ 头像 | 昵称 | 徽章
 ├─ 邮编 | 编辑按钮
 └─ 积分 / 勋章统计

[导航标签]
 ├─ 我的信件
 ├─ 我的作品
 ├─ 信使任务
 └─ 收藏&展览

[内容区]（随标签切换）
 ├─ 卡片式列表（信件/任务/作品）
 ├─ 状态标签（已送达/在路上/未读等）
 └─ 操作按钮（查看/回信/扫码/编辑）

[底部快捷操作]
 ├─ 写信
 ├─ 扫码
 ├─ 主页
 ├─ 广场
 └─ 通知
```

# 个人主页 PRD (V2.1 - 基于最新实现状态)

> **文档版本**: V2.2  
> **更新日期**: 2025-08-14  
> **实现完成度**: 95% (前端功能基本完成，待后端API集成)  
> **最新更新**: 评论系统(✅)、关注系统(✅)、公开主页访问(✅)、通知系统(✅)、用户发现(✅)、活动时间线(✅)

## **1. 模块概述**

个人主页是 OpenPenPal 平台的用户中心与功能集成入口，聚合用户的写信、收信、漂流信、作品、信使任务、积分等级等核心信息。

**🎯 设计愿景**：打造"博客式个人主页"，实现温柔社交的校园社区
**✅ 当前现状**：基础个人中心已实现，**社交功能基本完成**，已接近"博客式"体验目标

### 实现状态总览 (2025-08-14 更新)
- ✅ **个人信息管理**: 头像、昵称、资料编辑 (100%)
- ✅ **信件管理**: 收发信件查看、状态追踪 (100%) 
- ✅ **信使功能**: 任务管理、积分统计 (100%)
- ✅ **内容展示**: 信件分享、活动时间线 (95%)
- ✅ **社交互动**: 评论、关注、通知功能 (90%)
- ✅ **公开主页**: 独立用户主页访问 (95%)
- ✅ **用户发现**: 搜索、推荐、热门用户 (100%)
- ⚠️ **隐私控制**: 基础隐私设置 (40%)

---

## **2. 目标用户** (基于实际系统验证)

|**用户类型**|**行为特征**|**核心需求**|**当前实现状态**|**关键缺失**|
|---|---|---|---|---|
|**普通用户**|写信收信、浏览广场|信件管理、状态追踪、基础资料|✅ **100%实现**|无|
|**创作用户**|广场发布信件作品|作品展示、互动讨论|✅ **95%实现**|**高级内容管理**|
|**信使用户**|执行投递任务|任务管理、扫码操作、积分查看|✅ **100%实现**|无|
|**社交用户**|关注他人、互动讨论|关注列表、评论管理、访问他人主页|✅ **90%实现**|**完整隐私控制**|

### ✅ 关键突破 (2025-08-14)
当前系统**基本满足所有用户类型的核心需求**，"博客式个人主页"的产品定位已基本实现。主要缺失为高级隐私控制和推荐算法优化。

---

## **3. 功能范围** (全栈实现视角)

### **3.1 已实现功能模块** ✅

|**模块**|**功能要点**|**前端实现**|**后端API**|**数据库表**|
|---|---|---|---|---|
|**个人信息管理**|头像、昵称、OP Code、积分统计|✅ 完整|✅ 完整|`users`, `user_profiles`|
|**我的信件**|收发信件列表、状态追踪、回信入口|✅ 完整|✅ 完整|`letters`, `letter_codes`|
|**信使任务**|任务清单、扫码、积分、排行榜|✅ 完整|✅ 完整|`courier_tasks`, `courier_profiles`|
|**基础广场分享**|信件分享到广场、点赞功能|✅ 完整|✅ 完整|`letters` (visibility字段)|

### **3.2 已实现社交功能模块** ✅

|**模块**|**功能要点**|**前端状态**|**后端状态**|**数据库集成**|
|---|---|---|---|---|
|**评论系统**|个人主页留言、回复、管理|✅ 前端组件完成|⚠️ Mock数据演示|需后端API集成|
|**关注系统**|关注/取消关注、状态管理、乐观更新|✅ 完整状态管理|⚠️ Mock数据演示|需后端API集成|
|**公开主页**|`/u/username`访问、社交互动界面|✅ 路由和界面完成|⚠️ 基础用户信息|需完整用户Profile API|
|**用户发现**|搜索、推荐、热门用户展示|✅ 完整界面和交互|⚠️ Mock数据演示|需推荐算法API|
|**通知系统**|社交通知、批量操作、实时更新|✅ 完整状态管理|⚠️ Mock数据演示|需实时推送集成|

### **3.3 系统集成要求**

#### 与现有系统的深度集成
1. **写信系统集成** (`/frontend/src/app/(main)/write/`)
   - 评论功能需集成到信件详情页
   - 关注用户的信件需特殊标记和推荐

2. **广场系统集成** (`/frontend/src/app/plaza/`)
   - 评论组件需无缝嵌入广场信件卡片
   - 关注用户的内容需优先展示

3. **信使系统集成** (`/services/courier-service/`)
   - 个人主页需展示信使等级和成就
   - 关注的信使用户需要特殊标识

#### 前后端数据一致性要求
- **字段命名**: 严格遵循snake_case规范
- **类型映射**: TypeScript接口与Go结构体完全对应
- **状态同步**: 评论、关注状态的实时更新

---

### **3.2 操作入口**

- **主按钮区（底部导航）**：写信、扫码、主页、广场、通知
    
- **卡片操作按钮**：
    
    - 信件卡片：查看 / 回信 / 追踪
        
    - 作品卡片：查看 / 编辑 / 删除
        
    - 任务卡片：扫码确认 / 标记送达

---

## **4. 用户流程**

### **4.1 普通用户写信后的查看流程**

```
进入主页 → 我的信件 → 寄信记录 → 点击某封信 → 查看物流状态 / 回信按钮
```

### **4.2 信使任务流程**

```
进入主页 → 信使任务 → 今日任务清单 → 扫码录入编号 → 状态更新（在路上/已送达）
```

### **4.3 作品展示流程**

```
进入主页 → 我的作品 → 作品卡片 → 查看全文 / 收藏 / 分享
```

---

## **5. 界面结构**

### **5.1 页面布局**

1. **顶栏信息区**
    
    - 头像（点击可更换）
        
    - 昵称（点击可编辑）
        
    - 等级徽章（写信等级、信使等级）
        
    - 邮编信息（点击可修改）
        
    - 积分统计（写信积分 / 信使积分）

2. **标签栏（Tab）**
    
    - 📮 我的信件
        
    - 🖋 我的作品
        
    - 🎒 信使任务
        
    - 🏛 收藏 & 展览

3. **内容区**
    
    - 卡片式列表展示，附带状态与操作按钮

4. **底部导航**
    
    - 写信按钮、扫码按钮、主页、广场、通知

---

## **6. 数据结构（核心字段）**

|**数据对象**|**字段示例**|
|---|---|
|User|user_id, nickname, avatar, postcode, write_level, courier_level, points|
|Letter|letter_id, title, status, code, sender_id, receiver_id, send_time, read_time|
|Work|work_id, title, category, content, visibility, like_count, collect_count|
|Task|task_id, code, courier_id, status, assigned_time, completed_time|
|Badge|badge_id, type, level, icon_url|

---

## **7. 非功能需求**

|**类型**|**要求**|
|---|---|
|设备支持|移动端优先（H5 + 小程序），兼容Web端|
|性能|页面加载 ≤ 2 秒|
|安全|用户隐私受限展示，信封编号追踪不暴露实名信息|
|合规|内容审核机制、防敏感词|

---

## **8. 全栈实现规划** (基于实际开发优先级)

### **当前状态 (V2.2)** - ✅ 前端功能完成 (95%)
- 基础个人中心功能完整实现
- 与信件系统、信使系统无缝集成
- 基础广场分享功能运行良好
- **社交功能前端完成**: 评论、关注、通知、用户发现、活动时间线
- **公开主页功能完整**: `/u/username` 路由、关注按钮、留言板、用户动态
- **用户发现系统**: 搜索、推荐、热门用户、筛选排序

### **已完成开发 (V2.1)** - ✅ 核心功能完成 (2025-08-14)
|**功能模块**|**实现范围**|**关键集成点**|**文件位置**|
|---|---|---|---|
|**评论系统**|前端组件→个人主页集成→Mock数据演示|复用现有CommentList组件|`ProfileComments.tsx`|
|**关注系统**|FollowButton组件→状态管理→乐观更新|集成到公开主页和发现页|`follow-button.tsx`, `follow-store.ts`|
|**公开主页**|`/u/[username]`路由→公开信息展示→社交交互|包含关注按钮、留言板、活动时间线|`/u/[username]/page.tsx`|
|**通知系统**|通知铃铛→状态管理→实时推送|支持多种通知类型和批量操作|`NotificationBell.tsx`, `notification-store.ts`|
|**用户发现**|搜索、推荐、热门用户→关注集成|支持排序、筛选和防抖搜索|`/discover/page.tsx`|
|**活动时间线**|用户动态展示→时间线样式→加载更多|集成到个人资料标签页|`UserActivityFeed.tsx`|

### **待完成功能 (V2.2)** - ⚠️ 中优先级 (1-2周)  
|**功能模块**|**实现范围**|**预计工作量**|**优先级**|
|---|---|---|---|
|**隐私设置**|个人信息可见性控制、屏蔽功能|2-3天|中优先级|
|**后端API集成**|替换所有Mock数据为真实API|3-5天|高优先级|
|**推荐算法**|基于用户行为的智能推荐|1周|低优先级|

### **未来优化 (V3.0)** - 📋 低优先级 (2-3个月)
- 个性化主页主题和装饰
- 私信系统和深度社交交互
- 数据分析面板和用户画像
- 内容推荐算法优化

---

## **9. 立即行动计划**

### **第一步: 评论系统全栈实现**
1. **数据库设计** - 创建comments表
2. **后端API开发** - 评论CRUD接口
3. **前端组件开发** - 评论组件和管理界面
4. **系统集成** - 嵌入广场和个人主页

### **第二步: 关注系统实现**  
1. **用户关系数据模型**
2. **关注/取消关注API**
3. **关注列表和粉丝列表界面**
4. **基于关注的内容推荐**

### **第三步: 公开用户主页**
1. **用户主页路由设计**
2. **公开内容API**
3. **访客查看页面**
4. **隐私权限控制**

---

**📋 开始实现**: 立即着手评论系统的全栈开发，确保数据库→后端→前端的完整一致性