# OpenPenPal Enhanced Security Configuration
# Copy this file to .env and configure according to your environment

# Basic Environment Settings
ENVIRONMENT=production
HOST=localhost
PORT=8080

# Frontend Configuration
FRONTEND_URL=https://your-domain.com
WEBSOCKET_URL=wss://your-domain.com

# Security Headers Configuration
ENABLE_HSTS=true
ENABLE_CSP_REPORTING=true
CSP_REPORT_URI=/csp-report

# Trusted CDNs and External Resources
TRUSTED_CDNS=https://cdn.jsdelivr.net,https://fonts.googleapis.com,https://fonts.gstatic.com

# Database Configuration
DATABASE_URL=postgres://username:password@localhost:5432/openpenpal
DB_TYPE=postgres

# JWT Configuration
JWT_SECRET=your-super-secure-jwt-secret-here
JWT_EXPIRY=24h
REFRESH_TOKEN_EXPIRY=7d

# AI Service Configuration
AI_PROVIDER=moonshot
MOONSHOT_API_KEY=your-moonshot-api-key
MOONSHOT_BASE_URL=https://api.moonshot.cn

# Email Configuration
SMTP_HOST=smtp.your-provider.com
SMTP_PORT=587
SMTP_USER=your-email@domain.com
SMTP_PASSWORD=your-smtp-password
EMAIL_FROM=noreply@your-domain.com

# Redis Configuration (for rate limiting and caching)
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# Content Security Configuration
CONTENT_SECURITY_ENABLED=true
SENSITIVE_WORD_AUTO_UPDATE=true
XSS_PROTECTION_LEVEL=strict

# Rate Limiting Configuration
RATE_LIMIT_ENABLED=true
RATE_LIMIT_GENERAL=100  # requests per minute
RATE_LIMIT_AUTH=10      # auth requests per minute
RATE_LIMIT_ADMIN=50     # admin requests per minute

# Security Monitoring
SECURITY_MONITORING_ENABLED=true
THREAT_DETECTION_ENABLED=true
SECURITY_LOG_LEVEL=info

# File Upload Security
MAX_UPLOAD_SIZE=10485760  # 10MB in bytes
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,pdf,txt,md
SCAN_UPLOADS_FOR_MALWARE=true

# Cross-Origin Configuration
CORS_ALLOWED_ORIGINS=https://your-domain.com,http://localhost:3000
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,X-CSRF-Token

# Session Security
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict
SESSION_MAX_AGE=86400  # 24 hours

# Additional Security Features
ENABLE_AUDIT_LOGGING=true
ENABLE_INTRUSION_DETECTION=true
ENABLE_AUTOMATED_SECURITY_UPDATES=false
SECURITY_REPORT_EMAIL=security@your-domain.com

# Development Only (set to false in production)
DEBUG_MODE=false
DEVELOPMENT_TOOLS_ENABLED=false
HOT_RELOAD_ENABLED=false