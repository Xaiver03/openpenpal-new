
## **OpenPenPal 个人主页原型布局**

```
graph TD
    A[个人主页顶栏] --> A1[头像 + 昵称 + 等级徽章]
    A --> A2[邮编信息 + 编辑按钮]
    A --> A3[积分 / 勋章 / 信使等级统计]

    B[导航标签栏] --> B1[📮 我的信件]
    B --> B2[🖋 我的作品]
    B --> B3[🎒 信使任务]
    B --> B4[🏛 收藏 & 展览]

    C1[📮 我的信件页]
    C1 --> C1a[寄出记录(状态: 在路上/已送达)]
    C1 --> C1b[收信记录(已读/未读/回信入口)]
    C1 --> C1c[漂流信(匿名/公开标签)]
    C1 --> C1d[未来信(解锁时间显示)]

    C2[🖋 我的作品页]
    C2 --> C2a[公开信件]
    C2 --> C2b[随笔/短诗]
    C2 --> C2c[收藏夹]

    C3[🎒 信使任务页]
    C3 --> C3a[今日任务清单(编号/地点/状态按钮)]
    C3 --> C3b[扫码录入 & 确认送达]
    C3 --> C3c[历史任务记录]
    C3 --> C3d[信使积分 & 排行榜入口]

    C4[🏛 收藏 & 展览页]
    C4 --> C4a[精选信件数字展厅]
    C4 --> C4b[主题活动参展作品]
    C4 --> C4c[下载/分享按钮]
```

---

### **页面分区说明**

1. **顶栏（Header）**
    
    - 头像、昵称、等级徽章（写信等级/信使等级两种可能并列）
        
    - 邮编信息 + 快捷编辑
        
    - 积分总览（写信积分、信使积分）

2. **导航栏（Tab）**
    
    - 我的信件 / 我的作品 / 信使任务 / 收藏&展览
        
    - 适配移动端左右滑动

3. **内容区（Main Content）**
    
    - 不同标签切换内容
        
    - 列表卡片样式，每条信件/任务卡片都有状态标签与操作按钮

4. **底部操作栏（Mobile Friendly）**
    
    - 写信按钮
        
    - 扫码按钮（信封编号绑定/任务登记）
        
    - 主页、广场、商城、通知快捷入口

---

### **界面层次示意**

```
[顶栏] 
 ├─ 头像 | 昵称 | 徽章
 ├─ 邮编 | 编辑按钮
 └─ 积分 / 勋章统计

[导航标签]
 ├─ 我的信件
 ├─ 我的作品
 ├─ 信使任务
 └─ 收藏&展览

[内容区]（随标签切换）
 ├─ 卡片式列表（信件/任务/作品）
 ├─ 状态标签（已送达/在路上/未读等）
 └─ 操作按钮（查看/回信/扫码/编辑）

[底部快捷操作]
 ├─ 写信
 ├─ 扫码
 ├─ 主页
 ├─ 广场
 └─ 通知
```

# 个人主页 PRD (V2.0 - 基于实际实现状态)

> **文档版本**: V2.0  
> **更新日期**: 2025-08-10  
> **实现完成度**: 60% (基础功能完成，社交功能严重缺失)  
> **关键问题**: 评论系统(0%)、关注系统(0%)、公开主页访问(0%)

## **1. 模块概述**

个人主页是 OpenPenPal 平台的用户中心与功能集成入口，聚合用户的写信、收信、漂流信、作品、信使任务、积分等级等核心信息。

**🎯 设计愿景**：打造"博客式个人主页"，实现温柔社交的校园社区
**⚠️ 当前现状**：基础个人中心已实现，但**缺少关键社交功能**，无法实现真正的"博客式"体验

### 实现状态总览
- ✅ **个人信息管理**: 头像、昵称、资料编辑 (100%)
- ✅ **信件管理**: 收发信件查看、状态追踪 (100%) 
- ✅ **信使功能**: 任务管理、积分统计 (100%)
- ⚠️ **内容展示**: 基础信件分享 (40%)
- ❌ **社交互动**: 评论、关注、转发功能 (0%)
- ❌ **公开主页**: 独立用户主页访问 (0%)

---

## **2. 目标用户** (基于实际系统验证)

|**用户类型**|**行为特征**|**核心需求**|**当前实现状态**|**关键缺失**|
|---|---|---|---|---|
|**普通用户**|写信收信、浏览广场|信件管理、状态追踪、基础资料|✅ **100%实现**|无|
|**创作用户**|广场发布信件作品|作品展示、互动讨论|⚠️ **40%实现**|**评论系统、内容管理**|
|**信使用户**|执行投递任务|任务管理、扫码操作、积分查看|✅ **100%实现**|无|
|**社交用户**|关注他人、互动讨论|关注列表、评论管理、访问他人主页|❌ **0%实现**|**关注系统、公开主页**|

### 🚨 关键发现
当前系统**无法满足创作用户和社交用户的核心需求**，严重影响"博客式个人主页"的产品定位。

---

## **3. 功能范围** (全栈实现视角)

### **3.1 已实现功能模块** ✅

|**模块**|**功能要点**|**前端实现**|**后端API**|**数据库表**|
|---|---|---|---|---|
|**个人信息管理**|头像、昵称、OP Code、积分统计|✅ 完整|✅ 完整|`users`, `user_profiles`|
|**我的信件**|收发信件列表、状态追踪、回信入口|✅ 完整|✅ 完整|`letters`, `letter_codes`|
|**信使任务**|任务清单、扫码、积分、排行榜|✅ 完整|✅ 完整|`courier_tasks`, `courier_profiles`|
|**基础广场分享**|信件分享到广场、点赞功能|✅ 完整|✅ 完整|`letters` (visibility字段)|

### **3.2 关键缺失功能模块** ❌

|**模块**|**功能要点**|**前端状态**|**后端状态**|**需要新增数据库表**|
|---|---|---|---|---|
|**评论系统**|信件评论、回复、管理|❌ 完全缺失|❌ 完全缺失|`comments`, `comment_replies`|
|**关注系统**|关注/取消关注、粉丝列表|❌ 完全缺失|❌ 完全缺失|`user_follows`, `user_followers`|
|**公开主页**|`/u/username`访问、访客查看|❌ 完全缺失|❌ 完全缺失|需扩展现有`users`表|
|**内容管理**|个人发布内容的完整管理|⚠️ 基础功能|⚠️ 基础API|需优化`letters`表查询|

### **3.3 系统集成要求**

#### 与现有系统的深度集成
1. **写信系统集成** (`/frontend/src/app/(main)/write/`)
   - 评论功能需集成到信件详情页
   - 关注用户的信件需特殊标记和推荐

2. **广场系统集成** (`/frontend/src/app/plaza/`)
   - 评论组件需无缝嵌入广场信件卡片
   - 关注用户的内容需优先展示

3. **信使系统集成** (`/services/courier-service/`)
   - 个人主页需展示信使等级和成就
   - 关注的信使用户需要特殊标识

#### 前后端数据一致性要求
- **字段命名**: 严格遵循snake_case规范
- **类型映射**: TypeScript接口与Go结构体完全对应
- **状态同步**: 评论、关注状态的实时更新

---

### **3.2 操作入口**

- **主按钮区（底部导航）**：写信、扫码、主页、广场、通知
    
- **卡片操作按钮**：
    
    - 信件卡片：查看 / 回信 / 追踪
        
    - 作品卡片：查看 / 编辑 / 删除
        
    - 任务卡片：扫码确认 / 标记送达

---

## **4. 用户流程**

### **4.1 普通用户写信后的查看流程**

```
进入主页 → 我的信件 → 寄信记录 → 点击某封信 → 查看物流状态 / 回信按钮
```

### **4.2 信使任务流程**

```
进入主页 → 信使任务 → 今日任务清单 → 扫码录入编号 → 状态更新（在路上/已送达）
```

### **4.3 作品展示流程**

```
进入主页 → 我的作品 → 作品卡片 → 查看全文 / 收藏 / 分享
```

---

## **5. 界面结构**

### **5.1 页面布局**

1. **顶栏信息区**
    
    - 头像（点击可更换）
        
    - 昵称（点击可编辑）
        
    - 等级徽章（写信等级、信使等级）
        
    - 邮编信息（点击可修改）
        
    - 积分统计（写信积分 / 信使积分）

2. **标签栏（Tab）**
    
    - 📮 我的信件
        
    - 🖋 我的作品
        
    - 🎒 信使任务
        
    - 🏛 收藏 & 展览

3. **内容区**
    
    - 卡片式列表展示，附带状态与操作按钮

4. **底部导航**
    
    - 写信按钮、扫码按钮、主页、广场、通知

---

## **6. 数据结构（核心字段）**

|**数据对象**|**字段示例**|
|---|---|
|User|user_id, nickname, avatar, postcode, write_level, courier_level, points|
|Letter|letter_id, title, status, code, sender_id, receiver_id, send_time, read_time|
|Work|work_id, title, category, content, visibility, like_count, collect_count|
|Task|task_id, code, courier_id, status, assigned_time, completed_time|
|Badge|badge_id, type, level, icon_url|

---

## **7. 非功能需求**

|**类型**|**要求**|
|---|---|
|设备支持|移动端优先（H5 + 小程序），兼容Web端|
|性能|页面加载 ≤ 2 秒|
|安全|用户隐私受限展示，信封编号追踪不暴露实名信息|
|合规|内容审核机制、防敏感词|

---

## **8. 全栈实现规划** (基于实际开发优先级)

### **当前状态 (V1.0)** - ✅ 已完成 (60%)
- 基础个人中心功能完整实现
- 与信件系统、信使系统无缝集成
- 基础广场分享功能运行良好

### **紧急开发 (V1.1)** - 🚨 高优先级 (1-2个月)
|**功能模块**|**全栈实现范围**|**关键集成点**|
|---|---|---|
|**评论系统**|数据库表设计→后端API→前端组件→广场集成|与写信系统、广场系统深度集成|
|**关注系统**|用户关系表→关注API→关注组件→推荐算法|影响内容推荐和用户发现|
|**公开主页**|用户路由→公开API→访客页面→权限控制|需要新的页面架构和权限设计|

### **功能完善 (V1.2)** - ⚠️ 中优先级 (2-4个月)  
|**功能模块**|**全栈实现范围**|**技术要求**|
|---|---|---|
|**内容管理**|内容CRUD优化→管理界面→批量操作|优化现有API和数据库查询|
|**转发系统**|转发表设计→转发API→转发组件|与评论系统配合实现|
|**话题标签**|标签表→标签API→标签组件→搜索集成|需要全文搜索功能支持|

### **体验优化 (V2.0)** - 📋 低优先级 (4个月+)
- 个性化主页装饰
- 高级会员功能
- 数据分析面板

---

## **9. 立即行动计划**

### **第一步: 评论系统全栈实现**
1. **数据库设计** - 创建comments表
2. **后端API开发** - 评论CRUD接口
3. **前端组件开发** - 评论组件和管理界面
4. **系统集成** - 嵌入广场和个人主页

### **第二步: 关注系统实现**  
1. **用户关系数据模型**
2. **关注/取消关注API**
3. **关注列表和粉丝列表界面**
4. **基于关注的内容推荐**

### **第三步: 公开用户主页**
1. **用户主页路由设计**
2. **公开内容API**
3. **访客查看页面**
4. **隐私权限控制**

---

**📋 开始实现**: 立即着手评论系统的全栈开发，确保数据库→后端→前端的完整一致性