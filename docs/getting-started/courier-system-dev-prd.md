## **一、功能概述**

OpenPenPal 信使系统是连接线上信件寄送与线下递送服务的核心模块。该系统服务于不同等级的信使用户，实现信件的领取、流转、派送、追踪及积分奖励等功能，构建高效、透明、安全的实体书信传递网络。

---

## **二、角色与权限结构**

| **角色**      | **权限范围**               | **创建方式** | **上级权限管理** |
| ----------- | ---------------------- | -------- | ---------- |
| 系统管理员       | 管理所有信使账号、权限分配、任务调度异常处理 | 由平台创建    | 无上级        |
| 四级信使（城市总代）  | 管辖所辖城市学校的信件流转、创建三级信使   | 管理员授权    | 可管理三级信使    |
| 三级信使（校级）    | 管理本校信件中转与派发、创建二级信使     | 四级信使授权   | 可管理二级信使    |
| 二级信使（片区/年级） | 负责片区内信件整合派送、管理一级信使     | 三级信使授权   | 可管理一级信使    |
| 一级信使（楼栋/班级） | 实际收集与投递信件              | 二级信使邀请   | 无管理权限      |

> 所有权限操作记录需可审计；各级信使仅能管理下一级账号。

---

## **三、系统功能模块**

### **3.1 信使管理模块**

- 信使申请表单（实名、校区、片区、微信号等）
    
- 信使列表与权限控制（创建/授权/禁用）
    
- 信使等级与状态（申请中/活跃/禁用/冻结）

### **3.2 信件任务管理模块**

- 系统根据邮编编码自动生成信件派送任务
    
- 支持手动改派任务（管理员与上级信使权限）
    
- 信件状态：未领取 / 在途 / 已送达 / 异常
    
- 信件扫码记录（包含时间、位置、信使ID）

### **3.3 信件扫码流转系统**

- 一级信使：扫码确认收取与派送
    
- 上级信使：扫码流转上报状态（如“转交中”）
    
- 所有扫码信息绑定信封编号，实时更新状态链路

### **3.4 信使积分与成长系统**

- 每次成功扫码任务 +1 分，及时完成另加分
    
- 设置等级节点（初始信使 → 活跃信使 → 骨干 → 校区负责人）
    
- 排行榜：按学校/片区/全国查看送信量前十名
    
- 积分兑换模块（如接入文创商城）

### **3.5 异常处理机制**

- 信件扫码失败 / 编码错误：允许手动补录备注并上报
    
- 信件遗失或投递失败：信使提交反馈单，系统流转上报上级
    
- 平台支持一键冻结问题信件、重新指派新信使

---

## **四、核心交互路径**

### **4.1 信使领取任务**

```
用户投递信件 → 系统生成任务（依据邮编匹配信使） →
信使扫码确认收件 → 信件状态更新为“在途” →
送达后扫码确认 → 状态更新为“已送达”
```

### **4.2 信使管理关系维护**

```
系统管理员 → 创建四级信使 → 创建三级信使（校级）→
创建二级信使（片区） → 邀请一级信使 → 完成区域覆盖
```

---

## **五、页面与路由设计（参考）**

|**页面路径**|**模块**|**权限等级**|**功能**|
|---|---|---|---|
|/courier/apply|信使申请页|所有用户|提交成为信使表单|
|/courier/tasks|任务看板|信使|查看待投递/完成任务|
|/courier/scan|扫码界面|信使|扫码更新信件状态|
|/courier/record|任务记录页|信使|查看送信历史与积分|
|/admin/couriers|信使管理后台|管理员|创建/禁用/修改权限|
|/admin/tasks|任务管理后台|管理员/四级/三级|改派任务、查看任务流转情况|

### **5.1 原型架构（系统页面原型框架）**

```
graph TD
  A[登录页] --> B{用户角色识别}
  B --> C1[普通用户首页] 
  B --> C2[信使后台入口]
  B --> C3[管理员后台入口]

  C2 --> D1[信使任务看板]
  D1 --> D2[扫码页面]
  D1 --> D3[任务记录页]
  D1 --> D4[积分排名榜]

  C3 --> E1[信使管理页]
  C3 --> E2[任务改派页]
  C3 --> E3[系统日志页]

  C1 --> F1[写信/查看状态]
```

---

## **六、数据结构设计（简化版）**

### **表：courier**

- id（主键）
    
- name
    
- level（1-4）
    
- parent_id（上级ID）
    
- zone_code（负责区域编码）
    
- status（active/pending/frozen）

### **表：letter_task**

- id（主键）
    
- code（信封编号）
    
- courier_id（当前责任信使）
    
- status（unclaimed/in_transit/delivered/exception）
    
- timestamps

### **表：courier_log**

- id
    
- code_id
    
- courier_id
    
- action_type（scan_in / scan_out / exception）
    
- timestamp
    
- remarks

---

## **七、安全与审计**

- 所有扫码任务需登录后进行，防止数据篡改
    
- 权限操作记录日志保留30天
    
- 异常操作（如跳过扫码送达）将自动上报管理员后台

---

## **八、迭代建议**

|**版本**|**扩展内容**|
|---|---|
|V1.1|信使地图展示，任务量热力图可视化|
|V1.2|信使社群运营工具，如任务打卡、排行榜挑战赛|
|V1.3|接入中转站API，实现跨校分拣自动化|
|V2.0|AI优化派单逻辑，实现动态路线推荐|

---

如需配套内容（接口文档、数据库SQL文件），可继续指定输出方向。