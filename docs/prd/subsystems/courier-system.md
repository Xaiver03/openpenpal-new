## **一、模块定位**

信使系统是 OpenPenPal 实体信件流转的**执行与组织核心**，通过四级结构化管理，实现从城市 → 学校 → 片区 → 宿舍/店铺的“去中心化”人力投递网络。信使不仅仅是“派件员”，更是平台温度的传递者、社区的组织者、线下活动的执行者。

---

## **二、信使分级结构**

|**等级**|**称谓**|**管理范围**|**核心权限**|
|---|---|---|---|
|四级信使|城市负责人|所在城市所有学校|开通新学校，城市级物流调度，设计城市活动信封，管理前两位编码，批量生成条码（最多1000个/批次）|
|三级信使|校区负责人|所在学校（如北林大学）|任命二级信使，设计校内信封，管理3-4位编码段，调度本校物流，审核信使成长申请|
|二级信使|片区协调员|宿舍区/楼栋组/商业片区|管理5-6位编码段（宿舍点/商店点），审核新点位申请，分发任务给一级信使|
|一级信使|基础投递信使|宿舍楼栋、商店路径等|领取任务，扫码更新条码状态，完成实际派送流程，投递反馈|

---

## **三、功能模块结构**

### **3.1 信使申请与成长路径**

|**阶段**|**描述**|
|---|---|
|任命机制|上一级信使可邀请/审核任命下一级信使（如三级任命二级）|
|个人申请|用户主动申请成为信使 → 填写申请表单 → 上级信使审核|
|成长机制|每完成10单派送 + 参与2次活动 → 可申请晋升上一级|
|奖惩规则|任务失效/举报/恶意行为 → 扣除信誉分，累计后撤销资格|

---

### **3.2 信使任务系统**

|**模块**|**描述**|
|---|---|
|任务领取|根据自己可见编码段领取任务（如PK5F*内所有信件）|
|扫码登记|每次收信 → 扫码标记“已收件”；送信 → 扫码标记“已送达”|
|投递路径|平台可查询完整路径（收件人查看）|
|任务奖励|每次有效派送可获得积分/现金补贴（后续支持提现）|
|任务反馈|无法投递 → 填写原因并上报上级信使|

---

### **3.3 四级信使特殊功能**

|**功能模块**|**描述**|
|---|---|
|批量条码生成|生成1-1000个条码用于线下推广，需填写用途说明|
|条码分发管理|记录条码分发给下级信使或合作门店的详细信息|
|城市活动策划|设计城市级活动信封，组织大型手写信活动|
|数据统计面板|查看城市范围内的投递数据、信使绩效、条码使用率|
|资源调配|跨校区调配信使资源，应对高峰期派送需求|

---

### **3.4 点位管理（宿舍/商店）**

|**操作权限**|**描述**|
|---|---|
|二级信使审批|对宿舍/店铺的“成为固定投递点”申请进行审核|
|点位设置信息|点位名称、楼栋位置、开放时间、联系人、可否公开为投递点|
|点位映射地址码|每个点位绑定唯一 OP Code 编码（5-6位），进入可查系统|

---

## **四、用户流程图**

```
graph TD
A[申请成为信使] --> B[上级审核通过]
B --> C[领取任务]
C --> D[收件人地址匹配OP Code]
D --> E[扫码登记状态：已收/已派送]
E --> F[提交反馈或回信]
```

---

## **五、信使激励机制**

|**项目**|**机制**|
|---|---|
|任务完成奖励|每单补贴（如0.5元/封），可按月提现|
|排名系统|学校内信使排行公开展示，提供徽章、认证等荣誉|
|线下组织权|三级信使拥有活动组织权限（如“手写信节”“信封设计征集”等）|
|成长系统|信使等级系统：从 Lv.1 → Lv.5，解锁不同权限|

---

## **六、数据结构（简要）**

```
Courier {
  user_id: string,
  level: 1 | 2 | 3 | 4,
  assigned_region: string[], // OP Code 段落，如 PK5F*
  invitation_from: user_id,
  task_completed: number,
  active_status: boolean,
  badges: string[],
  reputation_score: number
}

DeliveryTask {
  task_id: string,
  barcode_id: string,
  from_code: string,
  to_code: string,
  current_status: "pending" | "in_transit" | "delivered" | "failed",
  assigned_courier: user_id,
  timestamp_log: DeliveryEvent[]
}
```

---

## **七、非功能性要求**

|**类别**|**要求**|
|---|---|
|权限控制|每位信使只能查看自己负责编码段落范围的任务与收件人编码|
|安全性|任务日志全程加密存储；扫码行为加时间戳与位置记录|
|实时性|任务状态变更需 ≤1s 同步至后台与用户端|
|稳定性|单信使每日最大并发任务量可达 100+，平台需支持负载均衡|

---

## **八、模块接口依赖**

|**模块**|**描述**|
|---|---|
|条码系统|扫码时需查询条码状态与绑定数据|
|编码系统|根据任务条码确定派送 OP Code 范围，控制访问权限|
|信封系统|部分任务为信封派送任务（如“活动信封推广”）|
|AI系统|漂流信转发或匿名信中转任务将委派至特定信使队列|
|后台管理端|管理员可查看城市/学校/点位/任务状态与信使评级|

---

下一模块为 🧭 编码系统，如无补充建议，我将继续输出 ✅

---


# 信使系统 PRD 更新日志

---
**Metadata**  
- **Type**: `Specification`
- **Status**: `Review` 
- **Author**: `[To be updated]`
- **Created**: `2025-08-12`
- **Updated**: `2025-08-12`
- **Version**: `v1.0.0`
- **Related**: `[To be updated]`
---


## 更新日期：2025-08-11

### 新增功能：四级信使批量条码生成权限

#### 更新内容

1. **信使分级结构更新**（第二节）
   - 四级信使核心权限新增：批量生成条码（最多1000个/批次）
   - 明确了四级信使在条码管理方面的特殊权限

2. **新增四级信使特殊功能章节**（第3.3节）
   - 批量条码生成：用于线下推广活动
   - 条码分发管理：追踪条码流向
   - 城市活动策划：组织大型活动
   - 数据统计面板：监控使用情况
   - 资源调配：跨校区管理

#### 关联更新
- 与条码系统 PRD 更新保持一致
- 四级信使作为城市总代，负责大规模条码分发
- 支持线下推广、校园活动等场景

#### 实施要点
1. 权限验证：确保只有Level 4信使可使用批量生成
2. 界面设计：在四级信使管理面板添加批量条码功能
3. 审计追踪：记录所有批量生成和分发行为
4. 使用统计：提供条码使用率分析功能